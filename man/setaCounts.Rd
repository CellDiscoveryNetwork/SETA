% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{setaCounts}
\alias{setaCounts}
\title{Extract Taxonomic Counts from Various Single Cell Objects}
\usage{
setaCounts(obj)
}
\arguments{
\item{obj}{Either a \code{SingleCellExperiment}, a \code{Seurat} object, or
a \code{data.frame} with columns \code{bc}, \code{type}, and \code{sample}.}
}
\value{
A matrix whose rows are cell types and whose columns are samples,
  with entries giving the count of unique barcodes per type-sample combination.
}
\description{
Given a \code{SingleCellExperiment}, \code{Seurat}, or long-form \code{data.frame},
this function produces a type-by-sample matrix of cell counts. For \code{SingleCellExperiment}
or \code{Seurat}, it looks for \code{type} and \code{sample} columns in the object-level metadata.
For long-form data frames, it expects columns \code{bc}, \code{type}, and \code{sample}.
}
\details{
\itemize{
  \item \strong{SingleCellExperiment}: Reads \code{colData(obj)} for \code{type} and \code{sample}.
  \item \strong{Seurat}: Uses \code{obj@meta.data} for \code{type} and \code{sample}.
  \item \strong{data.frame}: Duplicates (by \code{bc}) are removed so each cell is counted once.
}
If \code{type} or \code{sample} columns are missing, an error is thrown.
}
\examples{
\donttest{
# For a data.frame:
df <- data.frame(
  bc = paste0("cell", 1:10),
  type = sample(c("Tcell", "Bcell"), 10, TRUE),
  sample = sample(c("sample1","sample2"), 10, TRUE)
)
cmat <- setaCounts(df)
cmat
}

}
